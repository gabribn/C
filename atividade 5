#include <stdio.h>
#include <stdlib.h>

struct horario {
    int ano, mes, dia, hora, min;
};

struct cadastro {
    char placa[7];
    char modelo[10];
    char cor[10];
    struct horario entrada;
    struct horario saida;
    char status[1];
};
typedef struct cadastro veiculo;

int validacaoAno(veiculo v1, int bissexto){
   if((v1.entrada.ano%400==0) || ((v1.entrada.ano%4==0)&&(v1.entrada.ano%100!=0))){
        bissexto =1;
    }
    return bissexto;
}


void validacaoMes(veiculo v1){
    for(int i=0; i<1; i++){
        setbuf(stdin, NULL);
        scanf("%d", &v1.entrada.mes);
        if(v1.entrada.mes>12||v1.entrada.mes<1){
            printf("informe um mes valido\n");
            i--;
        }
    }
}

void inserir(FILE *f) {
    int bissexto = 0;
    int mes = 0;
    struct cadastro v1;
    printf("placa=");
    setbuf(stdin, NULL);
    gets(v1.placa);

    printf("modelo=");
    setbuf(stdin, NULL);
    gets(v1.modelo);

    printf("cor=");
    setbuf(stdin, NULL);
    gets(v1.cor);

    printf("informacoes sobre entrada=\n");
    printf("Ano=");
    setbuf(stdin, NULL);
    scanf("%d", &v1.entrada.ano);
    if((v1.entrada.ano%400==0) || ((v1.entrada.ano%4==0)&&(v1.entrada.ano%100!=0))){
        bissexto =1;
    }

    printf("mes=");
    validacaoMes(v1);



    printf("dia=");
    setbuf(stdin, NULL);
    scanf("%d", &v1.entrada.dia);

    printf("hora=");
    setbuf(stdin, NULL);
    scanf("%d", &v1.entrada.hora);

    printf("minutos=");
    setbuf(stdin, NULL);
    scanf("%d", &v1.entrada.min);

}

void alterar(FILE *f) {
    // COMPLETAR
}

void remover(FILE *f) {
    // COMPLETAR
}

void buscar(FILE *f) {
    // COMPLETAR
}

void listar(FILE *f) {
    // COMPLETAR
}

int main()
{
    FILE *f;
    f = fopen("C:\\Users\\facom.FACOM\\Documents\\projetos\\dados.txt", "rb+");
    if(f == NULL) {
        f = fopen("C:\\Users\\facom.FACOM\\Documents\\projetos\\dados.txt", "wb+");
        if(f == NULL) {
            printf("ERROR: Nao foi possivel abrir o arquivo.");
        }
    }

    int opcao = -1;
    while(opcao != 0) {
        printf("\n0 - sair\n1 - insere\n2 - altera\n3 - remove\n4 - busca\n5 - lista\n");
        printf("\nOpcao: "); scanf("%d", &opcao);
        switch(opcao) {
            case 1: inserir(f);
                    break;
            case 2: alterar(f);
                    break;
            case 3: remover(f);
                    break;
            case 4: buscar(f);
                    break;
            case 5: listar(f);
                    break;
            printf("\n\n\n");
        }
    }

    fclose(f);

    return 0;
}
